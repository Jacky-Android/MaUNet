# MaUNet
vmamba and cnn in remote sensing imgaes segment

Paper and code to be released soon 😏😏😏
# model view
```python
from torchinfo import summary    
x = torch.randn(1,3,512,512).cuda()
model = MaUNet(model='convnext_base',pretrain=False).cuda()
print(model(x).shape)
print(summary(model,(1,3,512,512)))

====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
MaUNet                                             [1, 6, 512, 512]          --
├─FeatureListNet: 1-1                              [1, 128, 128, 128]        --
│    └─Conv2d: 2-1                                 [1, 128, 128, 128]        6,272
│    └─LayerNorm2d: 2-2                            [1, 128, 128, 128]        256
│    └─ConvNeXtStage: 2-3                          [1, 128, 128, 128]        --
│    │    └─Identity: 3-1                          [1, 128, 128, 128]        --
│    │    └─Sequential: 3-2                        [1, 128, 128, 128]        415,488
│    └─ConvNeXtStage: 2-4                          [1, 256, 64, 64]          --
│    │    └─Sequential: 3-3                        [1, 256, 64, 64]          131,584
│    │    └─Sequential: 3-4                        [1, 256, 64, 64]          1,617,408
│    └─ConvNeXtStage: 2-5                          [1, 512, 32, 32]          --
│    │    └─Sequential: 3-5                        [1, 512, 32, 32]          525,312
│    │    └─Sequential: 3-6                        [1, 512, 32, 32]          57,424,896
│    └─ConvNeXtStage: 2-6                          [1, 1024, 16, 16]         --
│    │    └─Sequential: 3-7                        [1, 1024, 16, 16]         2,099,200
│    │    └─Sequential: 3-8                        [1, 1024, 16, 16]         25,344,000
├─Conv2d: 1-2                                      [1, 768, 16, 16]          787,200
├─ModuleList: 1-3                                  --                        --
│    └─Block: 2-7                                  [1, 256, 768]             768
│    │    └─Mamba: 3-9                             [1, 256, 768]             3,770,880
│    └─Block: 2-8                                  [1, 256, 768]             768
│    │    └─Mamba: 3-10                            [1, 256, 768]             3,770,880
│    └─Block: 2-9                                  [1, 256, 768]             768
│    │    └─Mamba: 3-11                            [1, 256, 768]             3,770,880
│    └─Block: 2-10                                 [1, 256, 768]             768
│    │    └─Mamba: 3-12                            [1, 256, 768]             3,770,880
│    └─Block: 2-11                                 [1, 256, 768]             768
│    │    └─Mamba: 3-13                            [1, 256, 768]             3,770,880
│    └─Block: 2-12                                 [1, 256, 768]             768
│    │    └─Mamba: 3-14                            [1, 256, 768]             3,770,880
│    └─Block: 2-13                                 [1, 256, 768]             768
│    │    └─Mamba: 3-15                            [1, 256, 768]             3,770,880
│    └─Block: 2-14                                 [1, 256, 768]             768
│    │    └─Mamba: 3-16                            [1, 256, 768]             3,770,880
│    └─Block: 2-15                                 [1, 256, 768]             768
│    │    └─Mamba: 3-17                            [1, 256, 768]             3,770,880
│    └─Block: 2-16                                 [1, 256, 768]             768
│    │    └─Mamba: 3-18                            [1, 256, 768]             3,770,880
│    └─Block: 2-17                                 [1, 256, 768]             768
│    │    └─Mamba: 3-19                            [1, 256, 768]             3,770,880
│    └─Block: 2-18                                 [1, 256, 768]             768
│    │    └─Mamba: 3-20                            [1, 256, 768]             3,770,880
│    └─Block: 2-19                                 [1, 256, 768]             768
│    │    └─Mamba: 3-21                            [1, 256, 768]             3,770,880
│    └─Block: 2-20                                 [1, 256, 768]             768
│    │    └─Mamba: 3-22                            [1, 256, 768]             3,770,880
│    └─Block: 2-21                                 [1, 256, 768]             768
│    │    └─Mamba: 3-23                            [1, 256, 768]             3,770,880
│    └─Block: 2-22                                 [1, 256, 768]             768
│    │    └─Mamba: 3-24                            [1, 256, 768]             3,770,880
│    └─Block: 2-23                                 [1, 256, 768]             768
│    │    └─Mamba: 3-25                            [1, 256, 768]             3,770,880
│    └─Block: 2-24                                 [1, 256, 768]             768
│    │    └─Mamba: 3-26                            [1, 256, 768]             3,770,880
│    └─Block: 2-25                                 [1, 256, 768]             768
│    │    └─Mamba: 3-27                            [1, 256, 768]             3,770,880
│    └─Block: 2-26                                 [1, 256, 768]             768
│    │    └─Mamba: 3-28                            [1, 256, 768]             3,770,880
│    └─Block: 2-27                                 [1, 256, 768]             768
│    │    └─Mamba: 3-29                            [1, 256, 768]             3,770,880
│    └─Block: 2-28                                 [1, 256, 768]             768
│    │    └─Mamba: 3-30                            [1, 256, 768]             3,770,880
│    └─Block: 2-29                                 [1, 256, 768]             768
│    │    └─Mamba: 3-31                            [1, 256, 768]             3,770,880
│    └─Block: 2-30                                 [1, 256, 768]             768
│    │    └─Mamba: 3-32                            [1, 256, 768]             3,770,880
├─Conv2d: 1-4                                      [1, 1024, 16, 16]         787,456
├─Decoder: 1-5                                     [1, 6, 512, 512]          105,392
│    └─Conv2d: 2-31                                [1, 64, 16, 16]           65,600
│    └─Eblock: 2-32                                [1, 64, 16, 16]           --
│    │    └─InceptionDWConv2d: 3-33                [1, 64, 16, 16]           272
│    │    └─InceptionDWConv2d: 3-34                [1, 64, 16, 16]           400
│    │    └─InceptionDWConv2d: 3-35                [1, 64, 16, 16]           592
│    │    └─SeparableConvBNReLU: 3-36              [1, 64, 16, 16]           104,128
│    └─Fusion: 2-33                                [1, 64, 32, 32]           --
│    │    └─Conv2d: 3-37                           [1, 64, 32, 32]           32,832
│    │    └─Sequential: 3-38                       [1, 64, 1, 1]             41,344
│    │    └─Sequential: 3-39                       [1, 64, 1, 1]             (recursive)
│    │    └─ConvBNReLU: 3-40                       [1, 64, 32, 32]           36,992
│    │    └─ConvBNReLU: 3-41                       [1, 64, 32, 32]           (recursive)
│    └─Eblock: 2-34                                [1, 64, 32, 32]           --
│    │    └─InceptionDWConv2d: 3-42                [1, 64, 32, 32]           272
│    │    └─InceptionDWConv2d: 3-43                [1, 64, 32, 32]           400
│    │    └─InceptionDWConv2d: 3-44                [1, 64, 32, 32]           592
│    │    └─SeparableConvBNReLU: 3-45              [1, 64, 32, 32]           104,128
│    └─Fusion: 2-35                                [1, 64, 64, 64]           --
│    │    └─Conv2d: 3-46                           [1, 64, 64, 64]           16,448
│    │    └─Sequential: 3-47                       [1, 64, 1, 1]             41,344
│    │    └─Sequential: 3-48                       [1, 64, 1, 1]             (recursive)
│    │    └─ConvBNReLU: 3-49                       [1, 64, 64, 64]           36,992
│    │    └─ConvBNReLU: 3-50                       [1, 64, 64, 64]           (recursive)
│    └─Eblock: 2-36                                [1, 64, 64, 64]           --
│    │    └─InceptionDWConv2d: 3-51                [1, 64, 64, 64]           272
│    │    └─InceptionDWConv2d: 3-52                [1, 64, 64, 64]           400
│    │    └─InceptionDWConv2d: 3-53                [1, 64, 64, 64]           592
│    │    └─SeparableConvBNReLU: 3-54              [1, 64, 64, 64]           104,128
│    └─Fusion: 2-37                                [1, 64, 128, 128]         --
│    │    └─Conv2d: 3-55                           [1, 64, 128, 128]         8,256
│    │    └─Sequential: 3-56                       [1, 64, 1, 1]             41,344
│    │    └─Sequential: 3-57                       [1, 64, 1, 1]             (recursive)
│    │    └─ConvBNReLU: 3-58                       [1, 64, 128, 128]         36,992
│    │    └─ConvBNReLU: 3-59                       [1, 64, 128, 128]         (recursive)
│    └─Sequential: 2-38                            [1, 6, 128, 128]          --
│    │    └─ConvBNReLU: 3-60                       [1, 64, 128, 128]         36,992
│    │    └─ConvBNReLU: 3-61                       [1, 64, 128, 128]         36,992
│    │    └─Conv2d: 3-62                           [1, 6, 128, 128]          390
====================================================================================================
Total params: 180,512,710
Trainable params: 180,512,710
Non-trainable params: 0
Total mult-adds (G): 7.40
====================================================================================================
Input size (MB): 3.15
Forward/backward pass size (MB): 1579.53
Params size (MB): 359.48
Estimated Total Size (MB): 1942.15
====================================================================================================
```
